<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.papermaking.mapper.PaperMapper">
    <resultMap id="BaseResultMap" type="com.papermaking.pojo.Paper">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="p_id" property="pId" jdbcType="INTEGER"/>
        <result column="p_name" property="pName" jdbcType="VARCHAR"/>
        <result column="c_id" property="cId" jdbcType="INTEGER"/>
        <result column="t_id" property="tId" jdbcType="INTEGER"/>
        <result column="p_test_types" property="pTestTypes" jdbcType="VARCHAR"/>
        <result column="p_score" property="pScore" jdbcType="INTEGER"/>
        <result column="p_createtime" property="pCreatetime" jdbcType="DATE"/>
        <result column="p_choiceSocre" property="pChoicesocre" jdbcType="INTEGER"/>
        <result column="p_fillBlankSocre" property="pFillblanksocre" jdbcType="INTEGER"/>
        <result column="p_answerSocre" property="pAnswersocre" jdbcType="INTEGER"/>
        <result column="p_judgeSocre" property="pJudgesocre" jdbcType="INTEGER"/>
        <result column="p_difflevel" property="pDifflevel" jdbcType="DOUBLE"/>
    </resultMap>

    <resultMap id="PaperMap" type="com.papermaking.pojo.Paper" extends="BaseResultMap">
        <association property="course" fetchType="lazy" column="c_id"
                    select="com.papermaking.mapper.CourseMapper.selectByPrimaryKey"/>
    </resultMap>

    <resultMap id="PaperQuestionMap" type="com.papermaking.pojo.Paper" extends="BaseResultMap">
        <collection property="questions" ofType="com.papermaking.pojo.Question" resultMap="com.papermaking.mapper.QuestionMapper.BaseResultMap">
        </collection>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from paper
        where p_id = #{pId,jdbcType=INTEGER}
    </delete>
    <insert id="insert" parameterType="com.papermaking.pojo.Paper" useGeneratedKeys="true" keyProperty="pId">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into paper (p_id, p_name, c_id,
        t_id, p_test_types, p_score,
        p_createtime, p_choiceSocre, p_fillBlankSocre,
        p_answerSocre, p_judgeSocre, p_difflevel
        )
        values (#{pId,jdbcType=INTEGER}, #{pName,jdbcType=VARCHAR}, #{cId,jdbcType=INTEGER},
        #{tId,jdbcType=INTEGER}, #{pTestTypes,jdbcType=VARCHAR}, #{pScore,jdbcType=INTEGER},
        #{pCreatetime,jdbcType=DATE}, #{pChoicesocre,jdbcType=INTEGER}, #{pFillblanksocre,jdbcType=INTEGER},
        #{pAnswersocre,jdbcType=INTEGER}, #{pJudgesocre,jdbcType=INTEGER}, #{pDifflevel,jdbcType=DOUBLE}
        )
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.papermaking.pojo.Paper">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update paper
        set p_name = #{pName,jdbcType=VARCHAR},
        c_id = #{cId,jdbcType=INTEGER},
        t_id = #{tId,jdbcType=INTEGER},
        p_test_types = #{pTestTypes,jdbcType=VARCHAR},
        p_score = #{pScore,jdbcType=INTEGER},
        p_createtime = #{pCreatetime,jdbcType=DATE},
        p_choiceSocre = #{pChoicesocre,jdbcType=INTEGER},
        p_fillBlankSocre = #{pFillblanksocre,jdbcType=INTEGER},
        p_answerSocre = #{pAnswersocre,jdbcType=INTEGER},
        p_judgeSocre = #{pJudgesocre,jdbcType=INTEGER},
        p_difflevel = #{pDifflevel,jdbcType=DOUBLE}
        where p_id = #{pId,jdbcType=INTEGER}
    </update>
    <select id="selectByPrimaryKey" resultMap="PaperQuestionMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
            select p.p_id, p.p_name, p.c_id, p.t_id, p.p_test_types, p.p_score, p.p_createtime, p.p_choiceSocre,
            p.p_fillBlankSocre, p.p_answerSocre, p.p_judgeSocre, p.p_difflevel,q.*
            from paper p inner join paper_question pq
            on p.p_id=pq.p_id and p.p_id = #{pId,jdbcType=INTEGER}
            inner join question q on pq.q_id=q.q_id

    </select>
    <select id="selectAll" resultMap="PaperMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select p_id, p_name, c_id, t_id, p_test_types, p_score, p_createtime, p_choiceSocre,
        p_fillBlankSocre, p_answerSocre, p_judgeSocre, p_difflevel
        from paper
    </select>

    <insert id="insertPaperQuestion">
        insert into paper_question(p_id,q_id) values
        <foreach collection="qIds" item="qId" separator=",">
            (
            #{pId},#{qId}
            )
        </foreach>
    </insert>

</mapper>